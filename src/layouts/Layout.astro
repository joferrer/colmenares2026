---
import FaviconLogo from "../assets/iconos/Centro_Demo.png";
import NavbarSuperior from "../components/ui/NavbarSuperior.astro";
import LoadingView from "../components/ui/LoadingView.astro";
import "../styles/global.css";
import Analytics from "@vercel/analytics/astro";
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/png" href={FaviconLogo.src} />
    <meta name="generator" content={Astro.generator} />
    <meta
      name="description"
      content="Soy cucuteña, periodista y por más de 15 años he investigado y expuesto los hechos más importantes de nuestra región, tanto los que nos han hecho sentir orgullo, como los que han sido una parte difícil de nuestra historia. El periodismo siempre ha sido una voz de los nortesantandereanos pero es momento de que pase a ser una representación que transforme nuestra realidad."
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Blinker:wght@100;200;300;400;600;700;800;900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <title>Estefanía Colmenares</title>
  </head>
  <body class="max-w-[3000px]">
    <LoadingView />
    <NavbarSuperior />
    <slot />
  </body>
</html>

<style is:global>
  html,
  body {
    margin: 0;
    width: 100%;
    height: 100%;
    font-family: "Montserrat", sans-serif;
  }

  html {
    scroll-behavior: smooth;
  }

  * {
    scroll-behavior: smooth;
  }
</style>

<script is:inline>
  // Configuración del scroll
  const SCROLL_DURATION = 300; // Milisegundos

  // Función de easing más suave
  function easeInOutQuart(t) {
    return t < 0.5 ? 8 * t * t * t * t : 1 - Math.pow(-2 * t + 2, 4) / 2;
  }

  // Función principal de smooth scroll
  function smoothScrollTo(element) {
    if (!element) return;

    const targetPosition =
      element.getBoundingClientRect().top + window.pageYOffset;
    const startPosition = window.pageYOffset;
    const distance = targetPosition - startPosition;
    const startTime = performance.now();

    function animation(currentTime) {
      const elapsed = currentTime - startTime;
      const progress = Math.min(elapsed / SCROLL_DURATION, 1);
      const ease = easeInOutQuart(progress);

      window.scrollTo(0, startPosition + distance * ease);

      if (progress < 1) {
        requestAnimationFrame(animation);
      }
    }

    requestAnimationFrame(animation);
  }

  // Manejar clicks en todos los links
  document.addEventListener("click", function (e) {
    const link = e.target.closest("a");
    if (!link) return;

    const href = link.getAttribute("href");
    if (!href) return;

    // Si es un anchor local
    if (href.startsWith("#")) {
      e.preventDefault();
      const targetId = href.substring(1);
      const targetElement = document.getElementById(targetId);

      if (targetElement) {
        smoothScrollTo(targetElement);
        history.pushState(null, "", href);
      }
    }
  });

  // Scroll inicial si hay hash en la URL
  window.addEventListener("load", function () {
    setTimeout(function () {
      const hash = window.location.hash;
      if (hash) {
        const targetId = hash.substring(1);
        const targetElement = document.getElementById(targetId);
        if (targetElement) {
          window.scrollTo(0, 0); // Reset primero
          setTimeout(function () {
            smoothScrollTo(targetElement);
          }, 100);
        }
      }
    }, 600); // Esperar a que el preloader termine
  });

  // Manejar navegación con botones atrás/adelante
  window.addEventListener("popstate", function () {
    const hash = window.location.hash;
    if (hash) {
      const targetId = hash.substring(1);
      const targetElement = document.getElementById(targetId);
      if (targetElement) {
        smoothScrollTo(targetElement);
      }
    }
  });
</script>
