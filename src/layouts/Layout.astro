---
import NavbarSuperior from "../components/ui/NavbarSuperior.astro";
import LoadingView from "../components/ui/LoadingView.astro";
import "../styles/global.css";
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<link
			href="https://fonts.googleapis.com/css2?family=Blinker:wght@100;200;300;400;600;700;800;900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Press+Start+2P&display=swap"
			rel="stylesheet"
		/>
		<title>Estefania Colmenares</title>
	</head>
	<body class="max-w-[3000px]">
		<LoadingView />
		<NavbarSuperior />
		<slot />
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
		font-family: "Montserrat", sans-serif;
	}
</style>

<script>
	const SCROLL_DURATION = 4500;
	const prefersReducedMotion = window.matchMedia(
		"(prefers-reduced-motion: reduce)"
	).matches;

	const easeInOutCubic = (t) =>
		t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;

	const smoothScrollTo = (target, duration = SCROLL_DURATION) => {
		const startY = window.pageYOffset;
		const targetY = startY + target.getBoundingClientRect().top;

		if (prefersReducedMotion || duration <= 0) {
			window.scrollTo(0, targetY);
			return;
		}

		const startTime = performance.now();
		const tick = (now) => {
			const elapsed = now - startTime;
			const t = Math.min(elapsed / duration, 1);
			const eased = easeInOutCubic(t);
			window.scrollTo(0, startY + (targetY - startY) * eased);
			if (t < 1) requestAnimationFrame(tick);
		};
		requestAnimationFrame(tick);
	};

	const scrollToHash = (hash, duration = SCROLL_DURATION) => {
		if (!hash) return;
		const target = document.querySelector(hash);
		if (!target) return;
		smoothScrollTo(target, duration);
	};

	window.__smoothScrollTo = smoothScrollTo;
	window.__scrollToHash = scrollToHash;

	document.addEventListener("click", (event) => {
		const link = event.target.closest("a");
		if (!link) return;
		const href = link.getAttribute("href");
		if (!href || href === "#") return;

		if (href.startsWith("#")) {
			event.preventDefault();
			history.pushState(null, "", href);
			scrollToHash(href);
			return;
		}

		try {
			const url = new URL(href, window.location.origin);
			const samePath = url.pathname === window.location.pathname;
			if (url.origin === window.location.origin && url.hash && samePath) {
				event.preventDefault();
				history.pushState(null, "", url.hash);
				scrollToHash(url.hash);
			}
		} catch {
			// Ignore invalid URLs.
		}
	});
</script>
