---
import FaviconLogo from "../../public/Centro_Demo.ico";
import OgImage from "../assets/fotos/COLMENARES2026.webp";
import NavbarSuperior from "../components/ui/NavbarSuperior.astro";
import LoadingView from "../components/ui/LoadingView.astro";
import "../styles/global.css";
import Analytics from "@vercel/analytics/astro";
import SpeedInsights from "@vercel/speed-insights/astro";

const { title, description, canonical, image } = Astro.props;

const siteUrl = "https://www.estefaniacolmenares.com";
const pageTitle = title ?? "Estefanía Colmenares | Candidata al Senado 2026";
const pageDescription =
  description ??
  "Estefanía Colmenares, periodista cucuteña y candidata al Senado de Colombia 2026. Conoce su trayectoria, propuestas y cómo participar.";
const pathname = Astro.url?.pathname ?? "/";
const canonicalUrl = canonical ?? new URL(pathname, siteUrl).toString();
const ogImageUrl =
  image ?? new URL(OgImage.src ?? OgImage, siteUrl).toString();

const structuredData = {
  "@context": "https://schema.org",
  "@type": "PoliticalCandidate",
  name: "Estefanía Colmenares",
  alternateName: ["Estefania Colmenares", "Estafania Colmenares"],
  jobTitle: "Candidata al Senado de Colombia 2026",
  url: canonicalUrl,
  image: ogImageUrl,
  description: pageDescription,
  sameAs: [
    "https://www.instagram.com/estefanianortecd?igsh=ZW9meThjMXRmcW02",
    "https://www.x.com/estcol",
    "https://www.tiktok.com/@estefanianortecd?_r=1&_t=ZS-92TSiuXL1NN",
  ],
};
---

<!doctype html>
<html lang="es-CO">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href={FaviconLogo} />
    <meta name="generator" content={Astro.generator} />
    <title>{pageTitle}</title>
    <meta name="description" content={pageDescription} />
    <link rel="canonical" href={canonicalUrl} />
    <meta name="robots" content="index, follow" />
    <meta property="og:site_name" content="Estefanía Colmenares" />
    <meta property="og:title" content={pageTitle} />
    <meta property="og:description" content={pageDescription} />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:type" content="website" />
    <meta property="og:image" content={ogImageUrl} />
    <meta property="og:image:alt" content="Estefanía Colmenares" />
    <meta property="og:locale" content="es_CO" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={pageTitle} />
    <meta name="twitter:description" content={pageDescription} />
    <meta name="twitter:image" content={ogImageUrl} />
    <meta name="twitter:site" content="@estcol" />
    <meta name="twitter:creator" content="@estcol" />
    <script
      type="application/ld+json"
      set:html={JSON.stringify(structuredData)}
    ></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Blinker:wght@100;200;300;400;600;700;800;900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="max-w-[3000px]">
    <Analytics />
    <SpeedInsights />
    <LoadingView />
    <NavbarSuperior />
    <slot />
  </body>
</html>

<style is:global>
  html,
  body {
    margin: 0;
    width: 100%;
    height: 100%;
    font-family: "Montserrat", sans-serif;
  }

  html {
    scroll-behavior: smooth;
  }

  * {
    scroll-behavior: smooth;
  }
</style>

<script is:inline>
  // Configuración del scroll
  const SCROLL_DURATION = 300; // Milisegundos

  // Función de easing más suave
  function easeInOutQuart(t) {
    return t < 0.5 ? 8 * t * t * t * t : 1 - Math.pow(-2 * t + 2, 4) / 2;
  }

  // Función principal de smooth scroll
  function smoothScrollTo(element) {
    if (!element) return;

    const targetPosition =
      element.getBoundingClientRect().top + window.pageYOffset;
    const startPosition = window.pageYOffset;
    const distance = targetPosition - startPosition;
    const startTime = performance.now();

    function animation(currentTime) {
      const elapsed = currentTime - startTime;
      const progress = Math.min(elapsed / SCROLL_DURATION, 1);
      const ease = easeInOutQuart(progress);

      window.scrollTo(0, startPosition + distance * ease);

      if (progress < 1) {
        requestAnimationFrame(animation);
      }
    }

    requestAnimationFrame(animation);
  }

  // Manejar clicks en todos los links
  document.addEventListener("click", function (e) {
    const link = e.target.closest("a");
    if (!link) return;

    const href = link.getAttribute("href");
    if (!href) return;

    // Si es un anchor local
    if (href.startsWith("#")) {
      e.preventDefault();
      const targetId = href.substring(1);
      const targetElement = document.getElementById(targetId);

      if (targetElement) {
        smoothScrollTo(targetElement);
        history.pushState(null, "", href);
      }
    }
  });

  // Scroll inicial si hay hash en la URL
  window.addEventListener("load", function () {
    setTimeout(function () {
      const hash = window.location.hash;
      if (hash) {
        const targetId = hash.substring(1);
        const targetElement = document.getElementById(targetId);
        if (targetElement) {
          window.scrollTo(0, 0); // Reset primero
          setTimeout(function () {
            smoothScrollTo(targetElement);
          }, 100);
        }
      }
    }, 600); // Esperar a que el preloader termine
  });

  // Manejar navegación con botones atrás/adelante
  window.addEventListener("popstate", function () {
    const hash = window.location.hash;
    if (hash) {
      const targetId = hash.substring(1);
      const targetElement = document.getElementById(targetId);
      if (targetElement) {
        smoothScrollTo(targetElement);
      }
    }
  });
</script>
